<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  <script type="text/javascript">
    google.charts.load('current', {packages:["orgchart"]});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
      var query = new google.visualization.Query('https://docs.google.com/spreadsheets/d/1AtYX7hzmdZ0AvQMyUCamBFm6jtvg5f9yHDLFGZQGo4g/gviz/tq?sheet=Coimbatore&range=A2:D');
      query.send(handleQueryResponse);
    }

    function handleQueryResponse(response) {
      if (response.isError()) {
        console.error('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
        return;
      }

      var data = response.getDataTable();

      // Draw the organization chart with basic HTML tooltips
      var chart = new google.visualization.OrgChart(document.getElementById('chart_div'));

      google.visualization.events.addListener(chart, 'onmouseover', function(e) {
        var tooltip = data.getValue(e.row, 2); // Assuming ToolTip is in column C

        if (tooltip) {
          var tooltipDiv = document.createElement('div');
          tooltipDiv.className = 'custom-tooltip';
          tooltipDiv.innerHTML = tooltip;

          var chartContainer = document.getElementById('chart_div');
          chartContainer.appendChild(tooltipDiv);

          // Position the tooltip beside the mouse cursor
          tooltipDiv.style.left = (e.clientX + 10) + 'px';
          tooltipDiv.style.top = (e.clientY + 10) + 'px';
        }
      });

      google.visualization.events.addListener(chart, 'onmouseout', function() {
        // Remove the tooltip when mouse leaves the node
        var chartContainer = document.getElementById('chart_div');
        var tooltipDiv = chartContainer.querySelector('.custom-tooltip');
        if (tooltipDiv) {
          chartContainer.removeChild(tooltipDiv);
        }
      });

      chart.draw(data, {allowHtml:true});
    }
  </script>
  <style>
    .custom-tooltip {
      position: absolute;
      padding: 10px;
      background-color: #f9f9f9;
      border: 1px solid #ccc;
      max-width: 200px;
    }
  </style>
</head>
<body>
  <div id="chart_div"></div>
</body>
</html>