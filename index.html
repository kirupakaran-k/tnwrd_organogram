<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Organization Chart</title>
    <!-- Load Google Charts API -->
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
        google.charts.load('current', {'packages':['orgchart']});
        google.charts.setOnLoadCallback(drawChart);

        function drawChart() {
            // Fetch data from Google Sheets JSON feed
            fetch('https://spreadsheets.google.com/feeds/list/1AtYX7hzmdZ0AvQMyUCamBFm6jtvg5f9yHDLFGZQGo4g/od6/public/values?alt=json')
                .then(response => response.json())
                .then(data => {
                    // Process the data into the required format
                    const chartData = [['Name', 'Manager ID']];
                    data.feed.entry.forEach(entry => {
                        chartData.push([entry.gsx$name.$t, entry.gsx$managerid.$t]);
                    });

                    // Create and draw the organization chart
                    const chart = new google.visualization.OrgChart(document.getElementById('chart_div'));
                    chart.draw(google.visualization.arrayToDataTable(chartData), {allowHtml:true});
                })
                .catch(error => console.error('Error fetching data:', error));
        }
    </script>
</head>
<body>
    <h1>Organization Chart</h1>
    <div id="chart_div"></div>
</body>
</html>
